<?php

/*
===========================================================

	프로젝트 이름 : 피리 웹프로그램

	만든사람 : 피리 PIREE

	홈페이지 : http://www.piree.co.kr

	작성날짜 : 2016년 05월 24일 화요일 오전 04시 07분 - 날씨 비옴

	저 작 권 : Copyright ⓒ 2014-2016 투스포츠 (원병철) All right reserved
							그누보드 외에 추가된 소스는~
							만든사람의 허락없이 무단으로 사용할수 없습니다.
							사용하고자 할 경우 만든사람의 허락을 받아야 합니다.
							http://www.piree.co.kr 에 문의해 주세요.

===========================================================
 피리 > 관리자 > 최고 회원 레벨
===========================================================


*/


	#########################################################
	# 시작 => 선처리
	#########################################################

	//=======================================================
	// 개별_페이지__접근_불가
	IF ( !defined('_GNUBOARD_') )										EXIT;

	#########################################################
	# 끝 => 선처리
	#########################################################



	#########################################################
	# 시작 => 그누보드__설정
	#########################################################

			#####################################################
			# 시작 => 필드__칼럼__추가하기
			#####################################################

			//===================================================
			// 시작 => 최고_회원_레벨
			IF ( !isset($config['cf_mem_max_level_n']) )
			{
					$sql = "ALTER TABLE `". $g5['config_table'] ."` ADD `cf_mem_max_level_n` TINYINT(4) UNSIGNED NOT NULL DEFAULT '0' AFTER `cf_10`";
					sql_query ($sql, false);
			}
			// 끝 => 최고_회원_레벨
			//===================================================

			#####################################################
			# 끝 => 필드__칼럼__추가하기
			#####################################################



			#####################################################
			# 시작 => 상수__변수__배열
			#####################################################

			//===================================================
			// 쿼리문__설정_수정
			$sql_config_arr = array();

			#####################################################
			# 끝 => 상수__변수__배열
			#####################################################



			#####################################################
			# 시작 => 단축_URL__관련
			#####################################################
			IF ( $cf_add__sh_url == 1 )
			{

					//===============================================
					// 시작 => 단축_URL__최대_번호
					IF ( !isset($config['cf_sh_url_domain_s']) )
					{
							$sql = "ALTER TABLE `". $g5['config_table'] ."` ADD `cf_sh_url_domain_s` VARCHAR(255) NOT NULL DEFAULT ''";
							sql_query ($sql, false);
					}
					// 끝 => 단축_URL__최대_번호
					//===============================================

			}
			#####################################################
			# 끝 => 단축_URL__관련
			#####################################################



			#####################################################
			# 시작 => 레벨_변경_확인_간격__관련
			#####################################################
			IF ( $cf_add__level_check_hour == 1 )
			{

					//===============================================
					// 시작 => 레벨_변경_확인_간격__필드__없으면
					IF ( !isset($config['cf_level_check_hour_n']) )
					{
							$sql = "ALTER TABLE `". $g5['config_table'] ."` ADD `cf_level_check_hour_n` INT(11) UNSIGNED NOT NULL DEFAULT '0'";
							sql_query ($sql, false);
					}
					// 끝 => 레벨_변경_확인_간격__필드__없으면
					//===============================================


					//===============================================
					// 시작 => 레벨_변경_확인_간격__다르면
					IF ( $level_check_hour_n != $config['cf_level_check_hour_n'] )
					{

							//===========================================
							// 쿼리문_수정_부분____레벨_변경_확인_간격__수정
							$sql_config_arr[] = "`cf_level_check_hour_n` = '". $level_check_hour_n ."'";

					}
					// 끝 => 레벨_변경_확인_간격__다르면
					//===============================================

			}
			#####################################################
			# 끝 => 레벨_변경_확인_간격__관련
			#####################################################



			#####################################################
			# 시작 => 피리_신고하기__관련
			#####################################################
			IF ( $cf_add__770006_report == 1 )
			{

					//===============================================
					// 시작 => 피리_신고하기__필드__없으면
					IF ( !isset($config['cf_report_v']) )
					{
							$sql = "ALTER TABLE `". $g5['config_table'] ."` ADD `cf_report_v` VARCHAR(255) NOT NULL DEFAULT ''";
							sql_query ($sql, false);
					}
					// 끝 => 피리_신고하기__필드__없으면
					//===============================================


					//===============================================
					// 시작 => 신고하기_설정_정보__있으면
					IF ( $p770006__config_s )
					{

							//===========================================
							// 쿼리문_수정_부분____신고하기_설정_정보
							$sql_config_arr[] = "`cf_report_v` = '". $p770006__config_s ."'";

					}
					// 끝 => 신고하기_설정_정보__있으면
					//===============================================

			}
			#####################################################
			# 끝 => 피리_신고하기__관련
			#####################################################

	#########################################################
	# 끝 => 그누보드__설정
	#########################################################



	#########################################################
	# 시작 => 회원__정보
	#########################################################

			#####################################################
			# 시작 => 기본__필드__추가하기
			#####################################################

			//===================================================
			// 회원정보__칼럼_추가하는_파일__첨부
			include_once(PIREE_PATH .'/p770016/member_fd_add.inc.php');

			#####################################################
			# 끝 => 기본__필드__추가하기
			#####################################################



			#####################################################
			# 시작 => 최고_회원_레벨__관련
			#####################################################

			//===================================================
			// 최고_회원_레벨__알아내기
			$sql = "SELECT MAX(mb_level) FROM `". $g5['member_table'] ."`";
			$mb_level = sql_efv($sql);


			//===================================================
			// 시작 => 최고_회원_레벨__있으면
			IF ( $mb_level > 0 )
			{

					//===============================================
					// 시작 => 최고_회원_레벨__다르면
					IF ( $mb_level != $config['cf_mem_max_level_n'] )
					{

							//===========================================
							// 쿼리문_수정_부분____최고_회원_레벨__수정
							$sql_config_arr[] = "`cf_mem_max_level_n` = '". $mb_level ."'";

					}
					// 끝 => 최고_회원_레벨__다르면
					//===============================================

			}
			// 끝 => 최고_회원_레벨__있으면
			//===================================================

			#####################################################
			# 끝 => 최고_회원_레벨__필드__추가하기
			#####################################################

	#########################################################
	# 끝 => 회원__정보
	#########################################################



	#########################################################
	# 시작 => 게시판__정보
	#########################################################

			#####################################################
			# 시작 => 기본__필드__추가하기
			#####################################################

			//===================================================
			// 시작 => 카테고리__수____칼럼__없으면
			IF ( !isset($board['bo_cate_now_t']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_cate_now_t` INT(11) UNSIGNED NOT NULL DEFAULT '0'";
					sql_query ($sql, false);
			}
			// 끝 => 카테고리__수____칼럼__없으면
			//===================================================


			//===================================================
			// 시작 => 끌어올림__사용____칼럼__없으면
			IF ( !isset($board['bo_uphill_use_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_uphill_use_n` TINYINT UNSIGNED NOT NULL DEFAULT '0'";
					sql_query ($sql, false);
			}
			// 끝 => 끌어올림__사용____칼럼__없으면
			//===================================================


			//===================================================
			// 시작 => 끌어올림__가능_레벨____칼럼__없으면
			IF ( !isset($board['bo_uphill_use_level_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_uphill_use_level_n` TINYINT UNSIGNED NOT NULL DEFAULT '0'";
					sql_query ($sql, false);
			}
			// 끝 => 끌어올림__가능_레벨____칼럼__없으면
			//===================================================


			//===================================================
			// 시작 => 끌어올림__시간_간격____칼럼__없으면
			IF ( !isset($board['bo_uphill_interval_H_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_uphill_interval_H_n` SMALLINT UNSIGNED NOT NULL DEFAULT '0'";
					sql_query ($sql, false);
			}
			// 끝 => 끌어올림__시간_간격____칼럼__없으면
			//===================================================


			//===================================================
			// 시작 => 끌어올림__포인트____칼럼__없으면
			IF ( !isset($board['bo_uphill_point_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_uphill_point_n` MEDIUMINT NOT NULL DEFAULT '-10'";
					sql_query ($sql, false);
			}
			// 끝 => 끌어올림__포인트____칼럼__없으면
			//===================================================


			//===================================================
			// 시작 => 끌어올림__게시판별_하루_제한_회수____칼럼__없으면
			IF ( !isset($board['bo_uphill_board_limit_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_uphill_board_limit_n` SMALLINT UNSIGNED NOT NULL DEFAULT '10'";
					sql_query ($sql, false);
			}
			// 끝 => 끌어올림__게시판별_하루_제한_회수____칼럼__없으면
			//===================================================


			//===================================================
			// 시작 => 끌어올림__메인_그룹_최신글_반영____칼럼__없으면
			IF ( !isset($board['bo_uphill_reload_latest_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_uphill_reload_latest_n` TINYINT UNSIGNED NOT NULL DEFAULT '1'";
					sql_query ($sql, false);
			}
			// 끝 => 끌어올림__메인_그룹_최신글_반영____칼럼__없으면
			//===================================================


			//===================================================
			// 시작 => 미니글__사용_여부
			IF ( !isset($board['bo_migl_use_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_migl_use_n` TINYINT UNSIGNED NOT NULL DEFAULT '0'";
					sql_query ($sql, false);
			}
			// 끝 => 미니글__사용_여부
			//===================================================


			//===================================================
			// 시작 => 오른쪽_왼쪽__구분_여부
			// 1 - 구분
			// 2 - 따로
			IF ( !isset($board['bo_migl_div_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_migl_div_n` TINYINT UNSIGNED NOT NULL DEFAULT '0'";
					sql_query ($sql, false);
			}
			// 끝 => 오른쪽_왼쪽__구분_여부
			//===================================================


			//===================================================
			// 시작 => 왼쪽__기준_몇줄
			IF ( !isset($board['bo_migl_row_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_migl_row_n` TINYINT UNSIGNED NOT NULL DEFAULT '0'";
					sql_query ($sql, false);
			}
			// 끝 => 왼쪽__기준_몇줄
			//===================================================


			//===================================================
			// 시작 => 왼쪽__메뉴
			IF ( !isset($board['bo_migl_left_menu_c']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_migl_left_menu_c` VARCHAR(20 ) NOT NULL DEFAULT ''";
					sql_query ($sql, false);
			}
			// 끝 => 왼쪽__메뉴
			//===================================================


			//===================================================
			// 시작 => 왼쪽__시간
			IF ( !isset($board['bo_migl_left_time_c']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_migl_left_time_c` VARCHAR(10 ) NOT NULL DEFAULT ''";
					sql_query ($sql, false);
			}
			// 끝 => 왼쪽__시간
			//===================================================


			//===================================================
			// 시작 => 오른쪽__메뉴
			IF ( !isset($board['bo_migl_right_menu_c']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_migl_right_menu_c` VARCHAR(20 ) NOT NULL DEFAULT ''";
					sql_query ($sql, false);
			}
			// 끝 => 오른쪽__메뉴
			//===================================================


			//===================================================
			// 시작 => 오른쪽__시간
			IF ( !isset($board['bo_migl_right_time_c']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_migl_right_time_c` VARCHAR(10 ) NOT NULL DEFAULT ''";
					sql_query ($sql, false);
			}
			// 끝 => 오른쪽__시간
			//===================================================


			//===================================================
			// 시작 => 게시글_투표_사용_여부____칼럼__없으면
			IF ( !isset($board['bo_article_vote_use_n']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_article_vote_use_n` TINYINT UNSIGNED NOT NULL DEFAULT '0'";
					sql_query ($sql, false);
			}
			// 끝 => 게시글_투표_사용_여부____칼럼__없으면
			//===================================================


			//===================================================
			// 시작 => 이미지_도우미__PC_스킨__사용하면
			IF ( !isset($board['image_helper_pc_skin']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `image_helper_pc_skin` VARCHAR(255) NOT NULL DEFAULT ''";
					sql_query ($sql, false);

			}
			// 끝 => 이미지_도우미__PC_스킨__사용하면
			//===================================================


			//===================================================
			// 시작 => 단축_URL__사용하면
			IF ( !isset($board['bo_sh_url_s']) )
			{
					$sql = "ALTER TABLE `". $g5['board_table'] ."` ADD `bo_sh_url_s` varchar(20) NOT NULL DEFAULT ''";
					sql_query($sql, false);

			}
			// 끝 => 단축_URL__사용하면
			//===================================================

			#####################################################
			# 끝 => 기본__필드__추가하기
			#####################################################

	#########################################################
	# 끝 => 게시판__정보
	#########################################################



	#########################################################
	# 시작 => 피리_웹프로그램__설정
	#########################################################

			#####################################################
			# 시작 => 문자열__필드__삭제
			#####################################################

			//===================================================
			// 시작 => 반복문
			FOR ( $i=21; $i<101; $i++ )
			{

					//===============================================
					// 지금_필드_이름
					$fd_this_s = "pgs_cf_". $i ."_s";


					//===============================================
					// 필드_추가하기
					$sql = "ALTER TABLE `". $piree['program_sam'] ."` DROP `". $fd_this_s ."`";
					sql_query ($sql, false);
			}
			// 끝 => 반복문
			//===================================================

			#####################################################
			# 끝 => 문자열__필드__삭제
			#####################################################



			#####################################################
			# 시작 => TEXT__필드__삭제
			#####################################################

			//===================================================
			// 시작 => 반복문
			FOR ( $i=6; $i<11; $i++ )
			{

					//===============================================
					// 지금_필드_이름
					$fd_this_s = "pgs_lpe_". $i;


					//===============================================
					// 필드_추가하기
					$sql = "ALTER TABLE `". $piree['program_sam'] ."` DROP `". $fd_this_s ."`";
					sql_query ($sql, false);
			}
			// 끝 => 반복문
			//===================================================

			#####################################################
			# 끝 => TEXT__필드__삭제
			#####################################################



			#####################################################
			# 시작 => 숫자__필드__삭제
			#####################################################

			//===================================================
			// 시작 => 반복문
			FOR ( $i=81; $i<120; $i++ )
			{

					//===============================================
					// 지금_필드_이름
					$fd_this_s = "pgs_cf_". $i ."_n";


					//===============================================
					// 필드_추가하기
					$sql = "ALTER TABLE `". $piree['program_sam'] ."` DROP `". $fd_this_s ."`";
					sql_query ($sql, false);
			}
			// 끝 => 반복문
			//===================================================

			#####################################################
			# 끝 => 숫자__필드__삭제
			#####################################################



			#####################################################
			# 시작 => 숫자__필드__추가
			#####################################################

			//===================================================
			// 시작 => 반복문
			FOR ( $i=61; $i<81; $i++ )
			{

					//===============================================
					// 이전_필드
					$fd_before_n = $i-1;


					//===============================================
					// 이전_필드_이름
					$fd_before_s = "pgs_cf_". $fd_before_n ."_n";


					//===============================================
					// 지금_필드_이름
					$fd_this_s = "pgs_cf_". $i ."_n";


					//===============================================
					// 필드_추가하기
					$sql = "ALTER TABLE `". $piree['program_sam'] ."` ADD `". $fd_this_s ."` INT NOT NULL DEFAULT '0' AFTER `". $fd_before_s ."`";
					sql_query ($sql, false);


/*

					//===============================================
					// 필드_추가하기
					$sql = "ALTER TABLE `". $piree['program_sam'] ."` DROP `". $fd_this_s ."`";
					sql_query ($sql, false);


					//===============================================
					// 필드_추가하기
					$sql = "ALTER TABLE `". $piree['program_sam'] ."` ADD `". $fd_this_s ."` INT NOT NULL DEFAULT '0' AFTER `". $fd_before_s ."`";
					sql_query ($sql, false);

*/

			}
			// 끝 => 반복문
			//===================================================

			#####################################################
			# 끝 => 숫자__필드__추가
			#####################################################

	#########################################################
	# 끝 => 피리_웹프로그램__설정
	#########################################################



	#########################################################
	# 시작 => 그누보드__설정__수정하기
	#########################################################

			//===================================================
			// 시작 => 사이트_설정_테이블__수정_쿼리_배열__있으면
			IF ( count($sql_config_arr) > 0 )
			{

					//===============================================
					// 정보_수정_쿼리문
					$sql_config_s = implode(', ', $sql_config_arr);


					//===============================================
					// 사이트_설정__수정하는__쿼리
					$sql	= "UPDATE `". $g5['config_table'] ."` SET ";
					$sql .= $sql_config_s;


					//===============================================
					// 시작 => 쿼리_실행
					IF ( !sql_query ($sql) )
					{
							// 에러
							alert ("[사이트 설정\"을 수정하지 못했습니다.");
							EXIT;
					}
					// 끝 => 쿼리_실행
					//===============================================

			}
			// 끝 => 사이트_설정_테이블__수정_쿼리_배열__있으면
			//===================================================

	#########################################################
	# 끝 => 그누보드__설정__수정하기
	#########################################################


?>